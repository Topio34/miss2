<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Pronostics Miss France</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0f172a;
      color: #e5e7eb;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
    }

    .card {
      background: #111827;
      padding: 24px;
      border-radius: 16px;
      max-width: 600px;
      width: 100%;
      box-shadow: 0 10px 30px rgba(0,0,0,0.4);
    }

    h1 {
      text-align: center;
      margin-top: 0;
    }

    label {
      display: block;
      margin: 12px 0 4px;
    }

    input, select, button {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: none;
      margin-bottom: 10px;
    }

    button {
      font-weight: bold;
      cursor: pointer;
    }

    .success { color: #22c55e; margin-top: 10px; }
    .error { color: #ef4444; margin-top: 10px; }

    table {
      width: 100%;
      margin-top: 20px;
      border-collapse: collapse;
      display: none;
    }
    th, td {
      padding: 6px;
      border-bottom: 1px solid #374151;
    }

  </style>
</head>
<body>

<div class="card">
  <h1>Pronostics Miss France ðŸ‘‘</h1>

  <form id="form">
    <label>Ton nom *</label>
    <input id="name" required />

    <label>Email *</label>
    <input id="email" type="email" required />

    <label>Mise (â‚¬) *</label>
    <input id="mise" type="number" min="1" value="1" required />

    <label>Choisis ta Miss *</label>
    <select id="miss" required>
      <option value="">-- Choisis --</option>
      <option>Miss Bretagne</option>
      <option>Miss Tahiti</option>
      <option>Miss Corse</option>
      <option>Miss Nord-Pas-de-Calais</option>
      <option>Miss ÃŽle-de-France</option>
      <!-- tu peux en rajouter -->
    </select>

    <button style="background:#22c55e; color:white;">Valider</button>
  </form>

  <button id="load" style="background:#1e40af; color:white;">ðŸ“Š Voir les votes</button>

  <p id="msg"></p>

  <table id="table">
    <thead>
      <tr>
        <th>Nom</th><th>Email</th><th>Mise</th><th>Choix</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

</div>

<script type="module">

  /* -----------------------------------------
     ðŸ”¥ 1) IMPORT FIREBASE
  ----------------------------------------- */
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

  
  /* -----------------------------------------
     ðŸš€ 2) TA CONFIG FIREBASE (COLLE TA VERSION ICI)
  ----------------------------------------- */
  const firebaseConfig = {
    apiKey: "AIzaSyClQ6YnEk_o3f80GRzQI3mJZD5oMC7-D1I",
    authDomain: "miss2-50355.firebaseapp.com",
    projectId: "miss2-50355",
    storageBucket: "miss2-50355.firebasestorage.app",
    messagingSenderId: "1039743844536",
    appId: "1:1039743844536:web:b9f2f8e9d1b4112beb744d"
  };


  /* -----------------------------------------
     ðŸŽ¯ 3) CONNECTION FIRESTORE
  ----------------------------------------- */
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const bets = collection(db, "votes");

  const form = document.getElementById("form");
  const msg = document.getElementById("msg");

  /* -----------------------------------------
     ðŸ“ 4) ENREGISTRER UN PARI
  ----------------------------------------- */
  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const name = document.getElementById("name").value.trim();
    const email = document.getElementById("email").value.trim();
    const mise = +document.getElementById("mise").value;
    const miss = document.getElementById("miss").value;

    if(!name || !email || !mise || !miss){
      msg.textContent = "âš ï¸ Remplis tout !";
      msg.className = "error";
      return;
    }

    msg.textContent = "â³ Enregistrement...";

    await addDoc(bets, { name, email, mise, miss });

    msg.textContent = "âœ”ï¸ EnregistrÃ© !";
    msg.className = "success";
    form.reset();
  });


  /* -----------------------------------------
     ðŸ“Œ 5) AFFICHER LES VOTES
  ----------------------------------------- */
  document.getElementById("load").addEventListener("click", async () => {
    msg.textContent = "â³ Chargement...";
    
    const table = document.getElementById("table");
    const tbody = table.querySelector("tbody");

    tbody.innerHTML = "";

    const snap = await getDocs(bets);
    snap.forEach(doc => {
      const v = doc.data();
      tbody.innerHTML += `
        <tr>
          <td>${v.name}</td>
          <td>${v.email}</td>
          <td>${v.mise}â‚¬</td>
          <td>${v.miss}</td>
        </tr>
      `;
    });

    table.style.display = "table";
    msg.textContent = "ðŸ“Œ Votes chargÃ©s.";
    msg.className = "success";
  });

</script>
</body>
</html>
